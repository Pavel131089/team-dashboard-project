import{j as t}from"./ui-CBbhuu0b.js";import{f,u as m,r as s}from"./vendor-DxaywbHF.js";import{s as g}from"./index-qiOd5fLb.js";const G=({children:u,requiredRole:r})=>{f();const l=m(),[c,a]=s.useState(null),[i,h]=s.useState(null),[o,n]=s.useState(null);return s.useEffect(()=>{(()=>{try{const e=g.getCurrentSession();if(console.log("AuthGuard: проверка сессии",e),!e||!e.isAuthenticated){console.log("AuthGuard: пользователь не аутентифицирован"),a(!1),n("/login");return}if(console.log("AuthGuard: пользователь аутентифицирован, роль:",e.role),a(!0),h(e.role),e.role!==r){console.log(`AuthGuard: роль не соответствует требуемой (${r})`);const d=e.role==="manager"?"/dashboard":"/employee";n(d)}else console.log("AuthGuard: роль соответствует требуемой"),n(null)}catch(e){console.error("Ошибка при проверке аутентификации:",e),a(!1),n("/login")}})()},[r]),s.useEffect(()=>{o&&(console.log("AuthGuard: перенаправление на",o),l(o,{replace:!0}))},[o,l]),c===null?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsx("div",{className:"animate-pulse",children:"Проверка авторизации..."})}):c&&i===r?(console.log("AuthGuard: показываем защищенный контент"),t.jsx(t.Fragment,{children:u})):t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsx("div",{className:"animate-pulse",children:"Перенаправление..."})})};export{G as default};
//# sourceMappingURL=AuthGuard-D5Q4ybht.js.map
